{"version":3,"sources":["./src/app/pages/homecitizen/homecitizen.page.ts","./src/app/pages/homecitizen/homecitizen.module.ts","./src/app/pages/homecitizen/homecitizen.page.html","./src/app/pages/homecitizen/homecitizen-routing.module.ts","./src/app/pages/homecitizen/homecitizen.page.scss"],"names":[],"mappings":"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","file":"pages-homecitizen-homecitizen-module.js","sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport {FirebaseService} from \"../../services/firebase.service\";\nimport firebase from 'firebase';\nimport {AlertController, ModalController, NavController, ToastController} from '@ionic/angular';\nimport {CitizenService} from '../../services/citizen.service';\nimport {Citizen} from '../../models/citizen';\nimport {NavigationExtras, Router} from '@angular/router';\nimport {AlarmService} from '../../services/alarm.service';\nimport {Alarm} from '../../models/alarm';\nimport {Geolocation} from '@ionic-native/geolocation/ngx';\nimport {ViewAlarmComponent} from '../../components/view-alarm/view-alarm.component';\nimport {User} from '../../models/user';\n\n@Component({\n  selector: 'app-homecitizen',\n  templateUrl: './homecitizen.page.html',\n  styleUrls: ['./homecitizen.page.scss'],\n})\nexport class HomecitizenPage implements OnInit {\n\n  citizen: Citizen;\n  alarms: Alarm[];\n  idcitizen: string;\n  namecitizen: string;\n  surnamecitizen: string;\n  getdate: string;\n  date: string;\n  lat: number;\n  lon: number;\n  idIntervention: number;\n\n  constructor(public firebaseService: FirebaseService,\n              public modalCtrl: ModalController,\n              public citizenService: CitizenService,\n              public router: Router,\n              public alarmService: AlarmService,\n              private geolocation: Geolocation,\n              public navCtrl: NavController,\n              public toastCtrl: ToastController,\n              public alertCtrl: AlertController) {firebase.auth().onAuthStateChanged(user => {\n    if (user) {\n      this.router.navigateByUrl('/homecitizen');\n    }\n    else {\n      this.router.navigateByUrl('/slides');\n    }\n  }); }\n\n  ngOnInit(): void {\n    this.idcitizen = localStorage.getItem('idCitizen');\n    this.citizenService.getCitizenById(this.idcitizen).subscribe( data => {\n      console.log(data);\n      this.citizen = data;\n      this.getAlarmsByIdCitizen();\n      this.namecitizen = data.userDTO.name;\n      this.surnamecitizen = data.userDTO.surname;\n      this.sendToken(data.userDTO.idUser, data.userDTO.name, data.userDTO.surname, data.userDTO.sex, data.userDTO.birthDate, data.userDTO.country, data.userDTO.address, data.userDTO.email, data.userDTO.city);\n    });\n    this.geolocation.getCurrentPosition().then((resp) => {\n      this.lat = resp.coords.latitude;\n      this.lon = resp.coords.longitude;\n      this.citizenService.updatePosition(this.idcitizen, this.lat, this.lon, this.citizen).subscribe( data => {\n        console.log(data);\n      });\n    }).catch((error) => {\n      console.log('Error getting location', error);\n    });\n  }\n\n  getAlarmsByIdCitizen(){\n    this.alarmService.getAlarmsByIdCitizen(this.idcitizen).subscribe(data => {\n      console.log(data);\n      this.alarms = data;\n    });\n  }\n\n  doRefresh(event) {\n    console.log('Begin async operation');\n    this.getAlarmsByIdCitizen();\n    setTimeout(() => {\n      console.log('Async operation has ended');\n      event.target.complete();\n    }, 2000);\n  }\n\n  async openViewAlarmModal(idIntervention){\n    console.log(idIntervention);\n    const modal = await this.modalCtrl.create({\n      component: ViewAlarmComponent,\n      componentProps: { value: idIntervention}\n    });\n\n    await modal.present();\n  }\n\nasync openPhotoPage(idIntervention){\n  const navigationExtras: NavigationExtras = {\n    state: {\n      idintervention: idIntervention\n    }\n  };\n  await this.router.navigateByUrl('/addphoto', navigationExtras);\n}\n\ndeleteAlarm(idAlarm){\n    this.alarmService.deleteAlarm(idAlarm).subscribe(data => {\n      console.log(data);\n      this.getAlarmsByIdCitizen();\n    });\n    this.presentToast();\n}\n\n  async presentToast() {\n    const toast = await this.toastCtrl.create({\n      message: 'Alarm Eliminated',\n      duration: 2000\n    });\n    await toast.present();\n  }\n\n  async presentAlert(idAlarm) {\n    const alert = await this.alertCtrl.create({\n      cssClass: 'my-custom-class',\n      header: 'Alert',\n      message: 'Are you sure?',\n      buttons: [{\n        text: 'Confirm',\n        handler: () => {\n          this.deleteAlarm(idAlarm);\n        }\n      },\n        {\n          text: 'Cancel',\n          role: 'cancel'\n        }]\n    });\n\n    await alert.present();\n  }\n\n  sendToken(idUser, name, surname, sex, birthDate, country, address, email, city){\n    birthDate = new Date(birthDate).toISOString();\n    console.log(birthDate);\n    const pushId = localStorage.getItem('token');\n    this.citizenService.updateCitizen(idUser, {name, surname, email, birthDate, sex, address, city, country, pushId} as User  ).subscribe(data => {\n      console.log(data);\n    });\n  }\n}\n\n\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { HomecitizenPageRoutingModule } from './homecitizen-routing.module';\n\nimport { HomecitizenPage } from './homecitizen.page';\nimport {OrderModule} from 'ngx-order-pipe';\n\n\n@NgModule({\n    imports: [\n        CommonModule,\n        FormsModule,\n        IonicModule,\n        HomecitizenPageRoutingModule,\n        OrderModule\n    ],\n  declarations: [HomecitizenPage]\n})\nexport class HomecitizenPageModule {}\n","export default \"<ion-header>\\n  <ion-toolbar>\\n    <ion-title>\\n      <img src=\\\"assets/icon/favicon.png\\\" width=\\\"50\\\">\\n    </ion-title>\\n    <ion-icon name=\\\"person-circle-outline\\\" slot=\\\"end\\\" (click)=\\\"router.navigateByUrl('/citizenprofile')\\\" style=\\\"font-size: 35px\\\" ></ion-icon>\\n  </ion-toolbar>\\n\\n</ion-header>\\n\\n<ion-content>\\n  <ion-refresher slot=\\\"fixed\\\" (ionRefresh)=\\\"doRefresh($event)\\\">\\n  </ion-refresher>\\n  <div id=\\\"container\\\">\\n  <ion-card>\\n    <ion-button expand=\\\"block\\\" (click)=\\\"router.navigateByUrl('/new-alarm')\\\" fill=\\\"outline\\\" color=\\\"dark\\\"><ion-icon name=\\\"alert-circle\\\"></ion-icon>Send Alarm</ion-button>\\n  </ion-card>\\n\\n  <ion-card *ngFor=\\\"let item of alarms | orderBy: idIntervention\\\">\\n    <ion-item>\\n      <ion-icon name=\\\"pin\\\" slot=\\\"start\\\"></ion-icon>\\n      Type: {{item.intervention.type.name}}\\n    </ion-item>\\n    <ion-item>\\n      <ion-icon name=\\\"alarm-outline\\\" slot=\\\"start\\\"></ion-icon>\\n         Alarm Date: {{item.alarmDate | date: 'medium'}}\\n    </ion-item>\\n    <ion-item>\\n      <ion-icon *ngIf=\\\"item.intervention.status == 'signaled'\\\" name=\\\"alert-circle-outline\\\" slot=\\\"start\\\"></ion-icon>\\n      <ion-icon *ngIf=\\\"item.intervention.status == 'assigned'\\\" name=\\\"checkmark-circle-outline\\\" slot=\\\"start\\\"></ion-icon>\\n      <ion-icon *ngIf=\\\"item.intervention.status == 'closed'\\\"   name=\\\"checkmark-done-circle-outline\\\" slot=\\\"start\\\"></ion-icon>\\n      Status: {{item.intervention.status}}\\n    </ion-item>\\n    <ion-item>\\n      <ion-button fill=\\\"outline\\\" color=\\\"warning\\\" slot=\\\"end\\\" *ngIf=\\\"item.intervention.status == 'signaled'\\\" (click)=\\\"openPhotoPage(item.intervention.idIntervention)\\\"><ion-icon name=\\\"camera\\\" slot=\\\"start\\\"></ion-icon>Add Photo</ion-button>\\n    <ion-button fill=\\\"outline\\\" slot=\\\"end\\\" (click)=\\\"openViewAlarmModal(item.intervention.idIntervention)\\\"><ion-icon name=\\\"reader\\\" slot=\\\"start\\\"></ion-icon>View</ion-button>\\n      <ion-button fill=\\\"outline\\\" color=\\\"danger\\\" slot=\\\"end\\\" *ngIf=\\\"item.intervention.status == 'signaled'\\\" (click)=\\\"presentAlert(item.idAlarm)\\\"><ion-icon name=\\\"trash-bin\\\" slot=\\\"start\\\"></ion-icon>Trash</ion-button>\\n    </ion-item>\\n  </ion-card>\\n  </div>\\n</ion-content>\\n<ion-button (click)=\\\"firebaseService.logout()\\\">Logout</ion-button>\\n\\n\\n\";","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { HomecitizenPage } from './homecitizen.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: HomecitizenPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class HomecitizenPageRoutingModule {}\n","export default \".my-custom-class {\\n  --background: #e5e5e5;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uXFwuLlxcLi5cXC4uXFxob21lY2l0aXplbi5wYWdlLnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRSxxQkFBQTtBQUNGIiwiZmlsZSI6ImhvbWVjaXRpemVuLnBhZ2Uuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIi5teS1jdXN0b20tY2xhc3Mge1xyXG4gIC0tYmFja2dyb3VuZDogI2U1ZTVlNTtcclxufVxyXG4iXX0= */\";"],"sourceRoot":"webpack:///"}